(self.webpackChunkcin_validator_fe=self.webpackChunkcin_validator_fe||[]).push([[551],{9271:function(e,n,t){var r={"./":[5154],"./index":[5154],"./index.js":[5154],"./pyodide":[2346,346],"./pyodide.js":[2346,346],"./static":[2539,539],"./static.js":[2539,539],"./web":[552,552],"./web.js":[552,552]};function a(e){if(!t.o(r,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=r[e],a=n[0];return Promise.all(n.slice(1).map(t.e)).then((function(){return t(a)}))}a.keys=function(){return Object.keys(r)},a.id=9271,e.exports=a},1342:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Le}});var r,a,i,o,l=t(8214),c=t(5861),s=t(9439),d=t(1413),u=t(390),h=t(1567),f=t(2345),p=t(4693),v=t(2678),Z=t(4625),g=(t(5634),t(4270)),b=t(4544),y=t(6022),x=t(2298),w=t(4563),A=t(5858),E=t(47),m=t(6138),C=t(168),j=t(9656),S=(j.Z.pre(r||(r=(0,C.Z)(["\n  white-space: normal;\n  word-wrap: break-word;\n"]))),j.Z.div(a||(a=(0,C.Z)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-evenly;\n"])))),k=j.Z.div(i||(i=(0,C.Z)(["\n  margin-top: 24px;\n"])));!function(e){e.UPDATE="UPDATE",e.SET_CHILDREN="SET_CHILDREN",e.SET_TABLES="SET_TABLES",e.SET_CHILD="SET_CHILD",e.SET_RULES="SET_RULES",e.SET_VALIDATION_RULES="SET_VALIDATION_RULES",e.HIDE_ROWS="HIDE_ROWS",e.RESET="RESET"}(o||(o={}));var L,I=function(e,n){var t=(0,d.Z)({},e);switch(n.type){case o.RESET:return{};case o.UPDATE:return t=(0,d.Z)({},n.payload);case o.SET_VALIDATION_RULES:return t.validationRules=n.payload,t;case o.SET_RULES:return t.rules=n.payload,t;case o.SET_TABLES:return t.tables=n.payload.tables,t;case o.SET_CHILDREN:return t.children=function(e,n){var t={};return Object.keys(e).forEach((function(n){JSON.parse(e[n]).forEach((function(e){t[e.LAchildID]||(t[e.LAchildID]={errors:{}})}))})),JSON.parse(n[0]).forEach((function(e){var r="".concat(e.rule_code," ").concat(e.tables_affected,"_").concat(e.columns_affected,"_").concat(e.row_id);if(!e.LAchildID)return!1;var a=JSON.parse(n[1]).filter((function(n){return n["Rule code"]===e.rule_code}))[0];t[e.LAchildID].errors[r]=(0,d.Z)((0,d.Z)({},e),a)})),Object.keys(e).forEach((function(n){JSON.parse(e[n]).forEach((function(e){t[e.LAchildID]&&(t[e.LAchildID][n]?t[e.LAchildID][n].push(e):t[e.LAchildID][n]=[e])}))})),t}(n.payload.tables,n.payload.errors),t.userReport=JSON.parse(n.payload.errors[3]),t.laWide=JSON.parse(n.payload.errors[1]),t.tables=n.payload.tables,t;case o.SET_CHILD:return t;case o.HIDE_ROWS:return t.children?(t.filter=n.payload,Object.values(t.children).forEach((function(e){if(!e.CINdetails)return!1;e.hide=e.CINdetails.LAchildID.indexOf(n.payload)<0})),t):t}return t};!function(e){e.ADD_FILES="ADD_FILES",e.SET_FILES="SET_FILES",e.CLEAR_FILES="CLEAR_FILES"}(L||(L={}));var O,_,R,D,T,N,P,U,B,H,F={},V=function(e,n){var t;switch(n.type){case L.CLEAR_FILES:return{};case L.ADD_FILES:return t=(0,d.Z)({},e),Object.keys(n.payload).length<1?t[n.year]=[]:t[n.year]=n.payload,t;case L.SET_FILES:return t=(0,d.Z)({},n.payload)}},W=t(3831),X=t(2559),M=function(e){var n=e.disableButtons,t=e.disableDownload,r=e.disableUserReport,a=e.onClearClick,i=e.onValidateClick,o=e.onGenerateClick,l=e.onReportClick;return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(W.Z,{variant:"contained",disabled:n,onClick:i,children:"Validate"}),(0,X.jsx)(W.Z,{disabled:n,variant:"contained",onClick:a,children:"Clear Data And Start Again"}),(0,X.jsx)(W.Z,{disabled:n||t,onClick:o,variant:"contained",children:"Download CSVs"}),(0,X.jsx)(W.Z,{disabled:n||r,variant:"contained",onClick:l,children:"Download Report"})]})},G=function(e){if(e.length<1)return null;var n=["data:text/csv;charset=utf-8,",Object.keys(e[0]).join(",")];return e.forEach((function(e){n.push(Object.values(e).map((function(e){return e||0===e?JSON.stringify(e).replaceAll(",","|"):"-"})).join(","))})),n.join("\n")},J=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file.txt",t=encodeURI(e),r=document.createElement("a");document.body.appendChild(r),r.download=n,r.href=t,r.click(),document.body.removeChild(r)},Q=t(7079),q=function(e){var n=e.dispatch,t=e.api,r=e.fileState,a=e.fileDispatch,i=e.data,d=i.validationRules,h=(0,u.useState)(!1),f=(0,s.Z)(h,2),p=f[0],v=f[1],C=(0,u.useState)(""),j=(0,s.Z)(C,2),k=j[0],I=j[1];(0,u.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,l.Z)().mark((function e(){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I("Loading rules"),v(!0),e.next=4,t.call("get_rules",{});case 4:r=e.sent,a=JSON.parse(r).map((function(e){return{value:e.code,label:e.description}})),n({type:o.SET_VALIDATION_RULES,payload:a}),T(O(a)),v(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var O=function(e){return 0===e.length?[]:e.map((function(e){return e.value}))},_=(0,u.useState)([]),R=(0,s.Z)(_,2),D=R[0],T=R[1],N=function(e){Object.keys(e).forEach((function(n){var t=G(Object.values(JSON.parse(e[n])));t&&J(t,"".concat(n,".csv"))}))},P=function(){return Object.values(r).reduce((function(e,n){return e+Object.values(n).length}),0)},U=function(){var a=(0,c.Z)((0,l.Z)().mark((function a(){var i,c,s,d,u;return(0,l.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t||!r){a.next=24;break}return i=r[2023],a.prev=2,I("Running analysis, this may take some time"),v(!0),c=Object.values(i)[0],a.next=8,t.call("generate_tables",c.file);case 8:return s=a.sent,d=[c.file],D.length>0&&d.push(D),a.next=13,t.call("cin_validate",d);case 13:u=a.sent,v(!1),n({type:o.SET_CHILDREN,payload:{tables:s,errors:u}}),e.handleRouteChange(H.REPORT),a.next=24;break;case 19:a.prev=19,a.t0=a.catch(2),v(!1),console.log("API add_files request failed",a.t0),alert("Something went wrong!");case 24:case"end":return a.stop()}}),a,null,[[2,19]])})));return function(){return a.apply(this,arguments)}}(),B=function(){var e=(0,c.Z)((0,l.Z)().mark((function e(){var a,c,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&r&&i)){e.next=22;break}if(i.tables){e.next=20;break}return a=r[2023],e.prev=3,I("Generating CSV file"),v(!0),c=Object.values(a)[0],e.next=9,t.call("generate_tables",c.file);case 9:s=e.sent,v(!1),N(s),n({type:o.SET_TABLES,payload:{tables:s}}),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(3),v(!1),console.log("API add_files request failed",e.t0),alert("Something went wrong!");case 20:e.next=23;break;case 22:N(i.tables);case 23:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(){return e.apply(this,arguments)}}();return(0,Q.BX)("div",{children:[p&&(0,Q.tZ)(Z.aN,{type:"cover",label:k}),(0,Q.BX)(A.Z,{flexGrow:1,children:[(0,Q.tZ)(Z.gO,{children:"This tool will load Python code in your web browser to read and validate your CIN data files locally. None of your CIN data will leave your network via this tool. You can safely use it without installing additional software, and without any data sharing agreement. Once the Python code has loaded, the tool will work entirely offline."}),(0,Q.BX)(Z.gO,{spacing:"blockLarge",children:["To begin, use the boxes below to locate and upload your local CIN file. Select the validation rules you want to run, and use the \u201cvalidate\u201d button to get started. By default, all rules will be run if no specific rules are selected.",(0,Q.tZ)("br",{}),(0,Q.tZ)("br",{}),'If you simply want to convert your XML file into CSVs, you can click on "download CSVs" without the need to go through the validation process first.']}),(0,Q.tZ)(Z.gO,{spacing:"blockLarge",children:(0,Q.tZ)(Z.qC,{Icon:m.Z,id:"instructions-list",title:"Instructions",children:function(){var e=[{label:"Upload an XML file for the CIN census by clicking on the arrow below. \n        If you have CSVs, convert them into XML using the DfE XML Generator.",content:null},{label:"If you only want to only run the validation for certain rules, use the\n        'Validation Rules' dropdown to select the ones you want.\n      ",content:null},{label:"Click 'Validate' to run the selected checks. When complete, the Error\n        Display screen will appear.\n      ",content:null},{label:"On the Error Display screen:",content:(0,Q.BX)("ul",{children:[(0,Q.tZ)("li",{children:(0,Q.tZ)(g.Z,{variant:"body2",children:"Use the 'Child ID' sidebar to select individual children."})}),(0,Q.tZ)("li",{children:(0,Q.tZ)(g.Z,{variant:"body2",children:"Scroll down to see the failing locations for the child across all recorded tables. Cells with errors are highlighted in blue when you click on the error description."})}),(0,Q.tZ)("li",{children:(0,Q.tZ)(g.Z,{variant:"body2",children:"If you click the 'Filter' button, you can type to search for a Child ID, or scroll down and click to display only children with a particular error."})}),(0,Q.tZ)("li",{children:(0,Q.tZ)(g.Z,{variant:"body2",children:"To download the Error Report spreadsheet, scroll to the bottom of the page and click the 'Download Error Reports' button"})})]})}];return(0,Q.tZ)(b.Z,{orientation:"vertical",activeStep:-1,children:e.map((function(e,n){return(0,Q.BX)(y.Z,{active:!0,children:[(0,Q.tZ)(x.Z,{children:e.label}),(0,Q.tZ)(w.Z,{children:e.content})]},e.label)}))})}()})}),(0,Q.tZ)(Z.gO,{spacing:"blockLarge",children:(0,Q.tZ)(A.Z,{children:function(){var e=[(0,Q.tZ)(A.Z,{children:(0,Q.tZ)(E.ZP,{container:!0,spacing:2,children:(0,Q.BX)(E.ZP,{item:!0,xs:12,children:[(0,Q.tZ)(g.Z,{variant:"h6",children:"Upload CIN XML file"}),(0,Q.tZ)(Z.gq,{onUploadReady:function(e){a({type:L.ADD_FILES,payload:e||{},year:"2023"})},maxFiles:1,fileList:r[2023]})]})})})];return(0,Q.tZ)(Z.mQ,{headers:[{label:"XML File"}],bodies:e,id:"file-upload-tabs"})}()})}),(0,Q.tZ)(Z.gO,{spacing:"blockLarge",children:d&&d.length>0&&(0,Q.tZ)(Z.qC,{defaultExpanded:!1,id:"validation-rules-expander",title:"Validation Rules (".concat(function(){if(!d)return"";var e=d.length,n=D.length,t=e-n;return"".concat(n," selected, ").concat(t," unselected")}(),")"),children:(0,Q.tZ)(Z.eR,{initialSelectedItems:O(d),values:d,onItemSelected:function(e){T(e)}})})}),(0,Q.tZ)(Z.gO,{spacing:"blockLarge",children:(0,Q.tZ)(S,{children:(0,Q.tZ)(M,{disableDownload:P()<1,disableButtons:P()<1||D.length<1,disableUserReport:!i||!i.userReport,onClearClick:function(){n({type:o.RESET,payload:{}}),a({type:L.CLEAR_FILES,payload:{},year:""})},onValidateClick:U,onGenerateClick:B,onReportClick:function(){}})})})]})]})},Y=t(7465),K=(j.Z.div(O||(O=(0,C.Z)(["\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n"]))),j.Z.div(_||(_=(0,C.Z)(["\n  overflow-x: hidden;\n  overflow-y: auto;\n  height: 100%;\n"])))),z=(j.Z.div(R||(R=(0,C.Z)(["\n  /*flex-grow: ",";*/\n  overflow-x: hidden;\n  overflow-y: auto;\n  //  align-self: stretch;\n  // display: flex;\n  //flex-direction: column;\n  height: 50%;\n"])),(function(e){return e.grow?e.grow:1})),j.Z.div(D||(D=(0,C.Z)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 "," "," ",";\n"])),Z.W0.s,Z.W0.m,Z.W0.s)),$=t(9172),ee=j.Z.div(T||(T=(0,C.Z)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]))),ne=function(e){var n=e.dispatch,t=e.filterString;return(0,X.jsx)(A.Z,{children:(0,X.jsx)(ee,{children:(0,X.jsx)($.Z,{value:t,label:"Child ID",size:"small",onChange:function(e){n({type:o.HIDE_ROWS,payload:e.currentTarget.value})}})})})},te=t(9962),re=t.n(te),ae=j.Z.div(N||(N=(0,C.Z)(["\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  position: relative;\n"]))),ie=j.Z.div(P||(P=(0,C.Z)(["\n  height: 50%;\n  overflow-x: auto;\n  overflow-y: auto;\n"]))),oe=j.Z.div(U||(U=(0,C.Z)(["\n  height: 50%;\n  overflow-x: auto;\n  overflow-y: auto;\n"]))),le=j.Z.div(B||(B=(0,C.Z)(["\n  position: absolute;\n  width: 100%;\n  background: ",';\n  height: 2px;\n  display: block;\n  left: 0;\n  top: 50%;\n  cursor: ns-resize;\n\n  &::after {\n    position: absolute;\n    content: "";\n    top: 50%;\n    height: 20px;\n    margin-top: -10px;\n    width: 40px;\n    background: white;\n    left: 50%;\n    margin-left: -20px;\n\n    border-radius: 4px;\n    background-color: ',';\n    background-repeat: repeat;\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAECAYAAABP2FU6AAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kTtIw1AUhv8+pCIVBYuIOGRonSyIijhqFYpQIdQKrTqY3PQFTRqSFBdHwbXg4GOx6uDirKuDqyAIPkBcXZwUXaTEc5NCixgPXO7Hf8//c++5gL9RYaoZHAdUzTLSyYSQza0KoVf4EEQ/BhGTmKnPiWIKnvV1T91Ud3Ge5d33Z/UqeZMBPoF4lumGRbxBPL1p6Zz3iSOsJCnE58RjBl2Q+JHrsstvnIsO+3lmxMik54kjxEKxg+UOZiVDJZ4ijiqqRvn+rMsK5y3OaqXGWvfkLwzntZVlrtMaQRKLWIIIATJqKKMCC3HaNVJMpOk84eEfdvwiuWRylcHIsYAqVEiOH/wPfs/WLExOuEnhBND1YtsfMSC0CzTrtv19bNvNEyDwDFxpbX+1Acx8kl5va9EjoG8buLhua/IecLkDDD3pkiE5UoCWv1AA3s/om3LAwC3Qs+bOrXWO0wcgQ7NK3QAHh8BokbLXPd7d3Tm3f3ta8/sBOVBykPd2vFUAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfnAQQQGQDysTUVAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAABBJREFUCNdj+P///38GVAAARc4D/b5MvWkAAAAASUVORK5CYII=");\n  }\n'])),Z.Hd.mid,Z.Hd.mid),ce=function(e){var n=e.topContent,t=e.bottomContent;(0,u.useEffect)((function(){var e=document.querySelector('td[scope="cell-active"]');null===e||void 0===e||e.scrollIntoView()}));var r=(0,u.useState)(0),a=(0,s.Z)(r,2),i=a[0],o=a[1],l=(0,u.useRef)(null),c=(0,u.useRef)(null),d=(0,u.useRef)(null),h=function(){var e,n=(null===(e=l.current)||void 0===e?void 0:e.clientHeight)||0,t=50,r=50;if(0!==i){var a=(n/2+(i<0?0-i:i))/n*100,o=100-a;t=i>0?a:o,r=i>0?o:a}return{top:t,bottom:r}}();return(0,X.jsxs)(ae,{ref:l,children:[(0,X.jsx)(ie,{style:{height:"".concat(h.top,"%")},ref:d,children:n}),(0,X.jsx)(oe,{style:{height:"".concat(h.bottom,"%")},children:t}),(0,X.jsx)(re(),{nodeRef:c,axis:"y",bounds:"parent",onDrag:function(e,n){var t=n.y;o(t)},children:(0,X.jsx)(le,{ref:c})})]})},se=t(7262),de=t(2453),ue=t(3677),he=t(3602),fe=t(8481),pe=t(9530),ve=t(8118),Ze=function(e){var n=e.content,t=e.highlight,r=e.selectedRow,a=e.handleClick,i=e.outline,o=e.rowIdx,l=e.lowlight,c=u.useState(null),d=(0,s.Z)(c,2),h=d[0],f=d[1],p=function(){f(null)},v=Boolean(h);return(0,Q.BX)(de.Z,{scope:i?"cell-active":"",role:i?"cell-active":"",sx:function(){var e={backgroundColor:"transparent",color:"#000"};return l&&(e.backgroundColor=Z.O9.secondary,e.color="#fff"),(o===r||i)&&(e.backgroundColor=Z.O9.primary,e.color="#fff"),e}(),onClick:a,children:[(0,Q.tZ)("span",{onMouseEnter:function(e){i&&null!==t&&void 0!==t&&t.description&&f(e.currentTarget)},onMouseLeave:p,children:n||"-"}),(0,Q.tZ)(ue.ZP,{id:"table-cell-popover-".concat(n),sx:{pointerEvents:"none"},open:v,anchorEl:h,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:p,disableRestoreFocus:!0,children:(0,Q.tZ)(g.Z,{variant:"body1",children:null===t||void 0===t?void 0:t.description})})]},"table-cell-".concat(n))},ge=function(e){var n=e.headers,t=e.rows,r=e.id,a=e.selectable,i=e.selectedHandler,o=e.highlight,l=e.lowlights,c=(0,u.useState)(-1),d=(0,s.Z)(c,2),h=d[0],f=d[1];(0,u.useEffect)((function(){f(-1)}),[r]);return(0,Q.BX)(fe.Z,{children:[(0,Q.tZ)(pe.Z,{children:(0,Q.tZ)(he.Z,{children:n.map((function(e,n){return(0,Q.tZ)(de.Z,{children:e},"table-head-".concat(r,"-").concat(n))}))})}),(0,Q.tZ)(ve.Z,{children:t.map((function(e,n){return(0,Q.tZ)(he.Z,{children:(t=e.cells,c=n,s=e.raw,t.map((function(e,n){var t=o&&o.row===c&&o.cell===n;return(0,Q.tZ)(Ze,{lowlight:l&&l["".concat(c,"_").concat(n)],outline:t,content:e,highlight:o,rowIdx:c,selectedRow:h,handleClick:function(){a&&(f(c===h?-1:c),i&&i(c===h?null:s))}},"".concat(c,"-").concat(n))})))},"table-row-".concat(r,"-").concat(n));var t,c,s}))})]})},be=function(e){var n=e.data,t=e.id,r=e.error,a=e.childErrors,i=e.validationRules;(0,u.useEffect)((function(){var e;r||(null===(e=document.querySelector("h5"))||void 0===e||e.scrollIntoView())}),[r]);var o=Object.keys(n[0]),l=n.map((function(e){return{cells:Object.values(e),raw:e}}));return(0,X.jsx)(ge,{lowlights:function(){if(a&&!(a.length<1)){var e={};return a.forEach((function(n){e["".concat(n.row_id,"_").concat(o.indexOf(n.columns_affected))]=!0})),e}}(),highlight:function(){if(!r)return null;var e=i.filter((function(e){return e.value===r.rule_code.toString()}));return{row:r.row_id,cell:o.indexOf(r.columns_affected),description:e.length>0&&e[0].label?e[0].label:""}}(),headers:o,rows:l,id:t})},ye=function(e){var n=e.errorList,t=e.errorSelectedHandler,r=e.childId;return(0,X.jsx)(ge,{selectable:!0,selectedHandler:function(e){t(e)},headers:["Rule Code","Rule Description"],rows:n.map((function(e){return{cells:[e.rule_code,e.rule_description],raw:e}})),id:"error-table-".concat(r)})},xe=function(e){var n=e.childItem,t=e.childId,r=e.validationRules,a=["Header","errors","hide"],i=(0,u.useState)(null),o=(0,s.Z)(i,2),l=o[0],c=o[1];(0,u.useEffect)((function(){c(null)}),[t]);return(0,X.jsx)(X.Fragment,{children:(0,X.jsx)(ce,{topContent:(0,X.jsxs)(Z.gO,{spacing:"blockLarge",children:[(0,X.jsx)(Z.gO,{spacing:"blockLarge",children:(0,X.jsxs)(g.Z,{variant:"h5",children:["Child ID: ",t]})}),function(){if(n){var e={};return Object.values(n.errors).forEach((function(n){e[n.tables_affected.toLowerCase()]||(e[n.tables_affected.toLowerCase()]=[]),e[n.tables_affected.toLowerCase()].push(n)})),Object.keys(n).map((function(t){return a.indexOf(t)>-1?null:(0,X.jsxs)(Z.gO,{spacing:"blockExtraLarge",children:[(0,X.jsx)(g.Z,{variant:"body1",children:(0,X.jsx)("strong",{children:(i=t,(0,se.startCase)(i))})}),(0,X.jsx)(be,{validationRules:r,childErrors:e[t.toLowerCase()]||null,error:l&&l.tables_affected.toLowerCase()===t.toLowerCase()?l:null,data:n[t],id:t},t)]},t);var i}))}return null}()]}),bottomContent:(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)("br",{}),(0,X.jsx)("br",{}),(0,X.jsx)(g.Z,{variant:"h5",children:"Errors"}),n.errors?(0,X.jsx)(ye,{errorSelectedHandler:function(e){c(e)},errorList:Object.values(n.errors),childId:t}):(0,X.jsx)(g.Z,{variant:"body1",children:"No errors found for this entry"})]})})})},we=function(e){var n=e.errors;return(0,X.jsxs)(Z.gO,{spacing:"blockLarge",children:[(0,X.jsx)(Z.gO,{spacing:"blockLarge",children:(0,X.jsx)(g.Z,{variant:"h5",children:"LA Wide Errors"})}),(!n||n.length)<1?(0,X.jsx)("p",{children:"No LA Wide Errors"}):(0,X.jsx)(ge,{headers:["Rule Code","Description"],id:"la-wide-errors",rows:n.map((function(e){return{cells:[e.rule_code,e.rule_description]}}))})]})},Ae=function(e){var n=e.handleRouteChange,t=e.api,r=e.data,a=e.dispatch,i=(0,u.useState)(null),d=(0,s.Z)(i,2),h=d[0],f=d[1],p=(0,u.useState)(!0),v=(0,s.Z)(p,2),b=v[0],y=v[1];(0,u.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,l.Z)().mark((function e(){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.call("get_children",{});case 2:return n=e.sent,e.next=5,t.call("get_errors",{});case 5:r=e.sent,a({type:o.SET_CHILDREN,payload:{children:JSON.parse(n.val),errors:JSON.parse(r)}});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object.values(r).length<1&&e()}));var x=function(e){f(e[0])};return(0,X.jsxs)(A.Z,{flexGrow:1,style:{height:"750px",overflowY:"hidden"},children:[(0,X.jsxs)(E.ZP,{container:!0,spacing:2,style:{height:"700px",overflowY:"hidden"},children:[(0,X.jsx)(E.ZP,{item:!0,xs:2,style:{height:"100%"},children:(0,X.jsxs)(K,{children:[(0,X.jsx)(Z.gO,{children:(0,X.jsx)(W.Z,{onClick:function(){f("LAWide")},children:"View LA-wide Errors"})}),(0,X.jsxs)(z,{children:[(0,X.jsx)(g.Z,{variant:"h6",children:"Child ID"}),(0,X.jsx)(Z.j0,{label:"Filter",children:(0,X.jsx)(ne,{filterString:r.filter,dispatch:a})})]}),(0,X.jsxs)(z,{children:[(0,X.jsx)(g.Z,{variant:"body2",children:"Hide children without errors"}),(0,X.jsx)(Y.Z,{onChange:function(){y(!b)},checked:b})]}),function(){if(!r.children)return null;var e=Object.values(r.children).filter((function(e){return!!e.ChildIdentifiers&&(!(Object.keys(e.errors).length<1&&b)&&!e.hide)})).map((function(e){return[e.ChildIdentifiers[0].LAchildID,e.errors?Object.keys(e.errors).length:0]}));return(0,X.jsx)(Z.VI,{headers:["Code","Count"],rows:e,onRowSelect:x})}()]})}),(0,X.jsx)(E.ZP,{item:!0,xs:10,style:{height:"100%"},children:"LAWide"===h?(0,X.jsx)(we,{errors:r.laWide}):h&&r.children&&r.children[h]&&r.validationRules?(0,X.jsx)(xe,{childId:h,childItem:r.children[h],validationRules:r.validationRules}):(0,X.jsx)(g.Z,{variant:"h6",children:"Select child"})})]}),(0,X.jsx)(Z.gO,{spacing:"blockLarge",children:(0,X.jsx)(k,{children:(0,X.jsx)(S,{children:(0,X.jsx)(M,{disableDownload:!1,disableButtons:!1,onClearClick:function(){a({type:o.RESET,payload:{}}),n(H.LOAD_DATA)},onValidateClick:function(){},onGenerateClick:function(){r&&r.tables&&Object.keys(r.tables).forEach((function(e){var n=G(Object.values(JSON.parse(r.tables[e])));n&&J(n,"".concat(e,".csv"))}))},onReportClick:function(){!function(){if(r&&r.userReport){var e=G(Object.values(r.userReport));e&&J(e,"User Report.csv")}}()}})})})})]})};!function(e){e.LOAD_DATA="LOAD_DATA",e.REPORT="REPORT"}(H||(H={}));var Ee=function(e){var n=(0,u.useState)(H.LOAD_DATA),t=(0,s.Z)(n,2),r=t[0],a=t[1],i=(0,d.Z)({handleRouteChange:function(e){a(e)}},e);return(0,X.jsx)(Z.uT,{title:"CIN Validator",chip:e.APIName||"Sample",children:r===H.LOAD_DATA?(0,X.jsx)(q,(0,d.Z)({},i)):r===H.REPORT?(0,X.jsx)(Ae,(0,d.Z)({},i)):void 0})},me=t(9516),Ce=(0,d.Z)({},Z.rS);Ce.components.MuiContainer.styleOverrides.maxWidthLg["&.MuiContainer-maxWidthLg"].maxWidth=1600;var je=(0,h.Z)(Ce),Se=void 0,ke=!0;var Le=function(e){var n=(0,u.useState)(!1),t=(0,s.Z)(n,2),r=t[0],a=t[1],i=(0,u.useReducer)(I,{}),o=(0,s.Z)(i,2),h=o[0],g=o[1],b=(0,u.useReducer)(V,(0,d.Z)({},F)),y=(0,s.Z)(b,2),x=y[0],w=y[1];(0,u.useEffect)((function(){var e=function(){var e=(0,c.Z)((0,l.Z)().mark((function e(){var n,t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.parse(window.location.search),t={options:{appName:"rpc_main:app"}},n.url?(t.transport=v.jG.WEB,t.options.url=n.url):(t.transport=v.jG.PYODIDE,t.options.nativePackages=["numpy","pandas"],t.options.packages=n.packages?n.packages:["/bin/dist/cin_validator-0.1.0-py3-none-any.whl","rpc-wrap","fs","plotly","prpc_python"]),e.next=5,(0,v.LC)(t,A);case 5:Se=e.sent;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();ke&&(ke=!1,e())}),[]);var A=function(e){null!==e&&void 0!==e&&e.error?(console.error("Failed to initialise API",e.error),alert("Failed to load pyodide")):e===v.Px.READY?a(!0):console.log("Unknown API response",e)};return(0,X.jsx)(f.Z,{theme:je,children:(0,X.jsx)(Z.W2,{children:r&&Se?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(Ee,{data:h,fileState:x,dispatch:g,fileDispatch:w,api:Se,APIName:e.APIName}),(0,X.jsx)(me.Z,{versionNumber:"".concat("0.2.0"," - ").concat("Tue May  9 10:01:57 UTC 2023"),sourceLink:"https://github.com/data-to-insight/cin-validator-fe"})]}):(0,X.jsx)(Z.aN,{type:"cover",label:"Loading Python API"})})})}},9516:function(e,n,t){"use strict";t.d(n,{Z:function(){return d}});t(390);var r,a=t(168),i=t(9656),o=t(4625),l=i.Z.div(r||(r=(0,a.Z)(["\n  position: relative;\n  width: 100%;\n  text-align: center;\n  bottom: 0;\n  right: 0;\n  color: ",";\n\n  a {\n    color: ",";\n  }\n"])),o.Hd.mid,o.Hd.mid),c=t(4270),s=t(2559),d=function(e){var n=e.versionNumber,t=e.sourceLink;return(0,s.jsx)(l,{children:(0,s.jsxs)(c.Z,{variant:"body2",children:["v",n," -"," ",(0,s.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:t})]})})}},5634:function(e,n,t){"use strict";t.d(n,{Z:function(){return g}});var r=t(9439),a=t(390),i=t(2803),o=t(3),l=t(2883),c=t(4971),s=t(5858),d=t(4270),u=t(47),h=t(3831),f=t(4625),p=t(8253).map((function(e){return{la_id:e.UTLA21CD,la_name:e.UTLA21NM}})).reduce((function(e,n){return e[n.la_id]=n,e}),{}),v=Object.values(p).sort((function(e,n){return e.la_name>n.la_name?1:-1})),Z=t(7079),g=function(e){var n=(0,a.useState)(""),t=(0,r.Z)(n,2),p=t[0],g=t[1];return(0,Z.BX)(s.Z,{flexGrow:1,children:[(0,Z.tZ)(f.gO,{children:(0,Z.tZ)(d.Z,{variant:"body1",children:"Data to Insight is a national project led by local authorities with support from the ADCS, DLUHC, DfE and Ofsted to help local authorities make better use of data."})}),(0,Z.tZ)(f.gO,{children:(0,Z.tZ)(d.Z,{variant:"body1",children:"This tool was developed by local authority data analysts, supported by technical expertise from our friends at Social Finance. It will let you perform the same kinds of data validation as the DfE\u2019s CIN (children in need) statutory data submission tool. You can run this tool at any time, using your year-to-date extract of CIN data. We recommend a monthly data checking cycle."})}),(0,Z.tZ)(f.gO,{spacing:"blockLarge",children:(0,Z.tZ)(u.ZP,{container:!0,spacing:2,children:(0,Z.tZ)(u.ZP,{item:!0,xs:6,children:(0,Z.BX)(i.Z,{fullWidth:!0,children:[(0,Z.tZ)(o.Z,{id:"la-select-label",children:"Choose local authority"}),(0,Z.tZ)(l.Z,{value:p,labelId:"la-select-label",label:"Choose local authority",onChange:function(e){console.log("set..."),g(e.target.value)},children:v.map((function(e){return(0,Z.tZ)(c.Z,{value:e.la_id,children:e.la_name},e.la_id)}))})]})})})}),(0,Z.tZ)(f.gO,{spacing:"blockLarge",children:(0,Z.tZ)(h.Z,{onClick:function(){try{gtag("event","cin-la-select",{localAuthority:p,localAuthorityName:v.filter((function(e){return e.la_id===p}))[0].la_name,event_callback:function(){console.log("callback..."),e.onClick()},debug_mode:!0})}catch(n){console.log(n)}},variant:"contained",sx:{boxShadow:0},disabled:""===p,children:"Start"})})]})}}}]);
//# sourceMappingURL=551.69c16977.chunk.js.map